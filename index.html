<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>FilmProbe - 影片助手</title>

  <link href="https://cdn.bootcdn.net/ajax/libs/tailwindcss/2.2.9/tailwind.min.css" rel="stylesheet">
  <style>
      .image {
          width: 100%;
          max-height: 100%;
          aspect-ratio: 71 / 100;
      }
  </style>

  <script src="https://cdn.bootcdn.net/ajax/libs/petite-vue/0.4.1/petite-vue.iife.min.js" defer init></script>
</head>
<body>
<div v-scope="{ filmList: [] }" class="container mx-auto bg-white">
  <div v-scope="{ search: '', searchHandler }" class="w-full mt-10 ">
    <div class="flex relative mx-3 md:mx-0">
      <input
          :value="search"
          @input="search = $event.target.value"
          @keyup.enter="searchHandler(search)"
          class="border-2 border-gray-300 bg-white w-full h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none"
          type="search" name="search" placeholder="Search">
      <button
          @click="searchHandler(search)"
          type="submit" class="absolute right-0 top-0 h-10 w-10"
          style="display: flex;justify-content: center;align-items: center">
        <svg t="1721709993430" class="text-gray-600 h-4 w-4 fill-current" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1483" width="32" height="32"><path d="M244.072422 374.434133c-5.005681 11.805512-19.752318 17.979953-32.430556 12.403989-12.378359-4.733995-18.282396-19.479351-12.943516-32.152463 7.048449-17.981235 16.486964-34.192668 26.226639-49.480114a378.437652 378.437652 0 0 1 35.940684-43.332585 280.427042 280.427042 0 0 1 43.910558-35.961188 275.658446 275.658446 0 0 1 49.544191-27.11987c12.678238-5.331191 27.723474 0.598477 32.429274 13.545838 5.60544 11.805512-0.598477 27.121151-13.276715 32.12555a264.739757 264.739757 0 0 0-40.973277 22.115471 333.234024 333.234024 0 0 0-36.267476 30.030239 267.88721 267.88721 0 0 0-30.062277 36.559666 275.207345 275.207345 0 0 0-22.092403 41.265467z m572.426356 383.462556l178.937061 179.45352a41.00916 41.00916 0 0 1 0.299879 58.950667 42.003632 42.003632 0 0 1-58.657195 0L757.541703 816.516719a444.40473 444.40473 0 0 1-116.117436 70.452455 450.588143 450.588143 0 0 1-172.734425 34.192669 455.128625 455.128625 0 0 1-173.632782-34.192669 456.816409 456.816409 0 0 1-244.940022-245.525684l-1.170043-2.040205a451.589022 451.589022 0 0 1-33.029033-170.933867 443.242377 443.242377 0 0 1 34.199076-172.399945A453.776605 453.776605 0 0 1 468.689842 15.778274 454.901794 454.901794 0 0 1 641.126951 50.242628l0.298598 0.298598v-0.298598a463.787966 463.787966 0 0 1 147.104982 98.450178l1.740326 2.040205a454.945366 454.945366 0 0 1 96.398438 144.707228l0.897075 2.365716a446.939609 446.939609 0 0 1-0.897075 343.640098 465.801259 465.801259 0 0 1-70.165391 116.450636zM610.163754 126.870806A371.431494 371.431494 0 0 0 126.461996 326.994224c-18.01071 43.604271-27.424876 91.373534-27.424875 141.475194a378.76957 378.76957 0 0 0 26.5278 139.980922l0.897075 1.467359a380.959715 380.959715 0 0 0 80.449719 120.259361 368.02517 368.02517 0 0 0 120.281147 80.163936c43.03655 17.950478 90.784027 27.690154 141.49698 27.690154a365.467224 365.467224 0 0 0 260.585016-107.282525l0.570284-0.571565a374.376464 374.376464 0 0 0 80.204946-120.259361c18.256765-43.032705 27.968247-91.044179 27.968246-141.449563a368.039267 368.039267 0 0 0-27.096802-139.13639l-0.871444-2.040205c-18.609188-44.22966-44.835827-84.59677-78.136547-118.190962l-2.068399-1.76852c-34.197795-34.165756-75.171071-61.884104-119.681388-79.864057v-0.597196z m101.100394 341.598612a25.41799 25.41799 0 0 1 25.056596-25.052752 25.007898 25.007898 0 0 1 25.057879 25.052752 297.604754 297.604754 0 0 1-22.391002 112.561172l-0.299879 0.598478a292.432473 292.432473 0 0 1-157.987788 157.38931 291.206043 291.206043 0 0 1-112.006267 22.658843 25.039937 25.039937 0 1 1 0-50.078592c31.525792 0 63.064398-6.499952 93.127957-18.278552a241.078753 241.078753 0 0 0 78.430018-52.744187 237.107272 237.107272 0 0 0 52.158525-77.796939l0.871444-1.170042a246.677785 246.677785 0 0 0 17.983798-93.139491z" fill="#3B3F51" p-id="1484"></path></svg>
      </button>
    </div>
  </div>
  <div class="mb-20 w-full px-3 md:mx-0">
    <template v-for="el in filmList" :key="el.name">
      <div class="mt-10">
        <div class="flex justify-between">
          <div class="font-bold text-lg">
            <span v-text="el.name"></span>
            <span>({{ el.type }})</span>
          </div>
          <span class="text-[14px] leading-7 hover:underline text-slate-700"><a :href="el.searchUrl" target="_blank">查看更多</a></span>
        </div>
        <div v-if="el.viewType == 'IMAGE'" class="grid grid-cols-3 md:grid-cols-6 gap-2 md:gap-4">
          <div v-if="!el.films || el.films.length == 0">
            暂无内容
          </div>
          <div class="w-full" v-for="film in el.films" :key="String(el.name + film.name)">
            <a :href="film.url" target="_blank">
              <img :src="'/proxy?url=' + film.img" :alt="film.name" src="" class="image rounded">
            </a>
            <div class="overflow-hidden" style="max-height: 44px; text-overflow: ellipsis">
              <a :href="film.url" target="_blank"
                 class="hover:underline " v-text="film.name"></a>
            </div>
          </div>
        </div>

        <div v-if="el.viewType == 'TEXT'" class="">
          <div v-if="!el.films || el.films.length == 0">
            暂无内容
          </div>
          <div class="w-full my-2" v-for="film in el.films" :key="String(el.name + film.name)">
            <div style="max-height: 44px; overflow: hidden; text-overflow: ellipsis">
              <a :href="film.url" target="_blank"
                 class="hover:underline " v-text="film.name"></a>
            </div>
            <div style="font-size: 13px; color: #666; max-height: 44px; margin-top: 6px; text-overflow: ellipsis" class="overflow-hidden">
              <span>{{ film.other }}</span>
            </div>
          </div>
        </div>
      </div>
    </template>
  </div>
</div>

<script>
    function searchHandler(word) {
        if (!word) {
            return;
        }
        fetch(`/search?w=${word}`).then(res => res.json()).then(data => {
            data.sort((a, b) => b.type.localeCompare(a.type));
            this.filmList = data;
        });
    }
</script>
</body>
</html>
